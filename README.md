# NBA Injuries Prediction Project

This repository contains a machine learning project to predict NBA player injuries based on historical injury data. The project is structured into three main scripts: `train.py`, `eval.py`, and `infer.py`.

## Prerequisites
- Python 3.8+
- Install dependencies:
  ```bash
  pip install pandas sklearn xgboost joblib gdown
  ```

## Files
- **train.py**: Downloads the dataset, preprocesses it, trains multiple models (Logistic Regression, Decision Tree, Random Forest, XGBoost, Bagging), and saves model weights and test data split to disk.
- **eval.py**: Loads model weights and test data, evaluates each model, and reports classification metrics (precision, recall, F1-score) and confusion matrices.
- **infer.py**: Loads the model weights and predicts injury status for a user-defined input row.

## Dataset
The dataset (`injuries.csv`) is hosted on Google Drive:
- **Link**: [injuries.csv](https://drive.google.com/file/d/1dFx7-J_D1PQQeoRvLyNZ1QH2nt7oCCCJ/view?usp=sharing)
- The dataset is automatically downloaded by `train.py` using the `gdown` library.

## Model Weights
Model weights and the test data split are saved during training and can be accessed here:
- **Link**: [Model Weights and Test Data](https://drive.google.com/drive/folders/EXAMPLE_FOLDER_ID?usp=sharing)
- Files: `model_logistic_regression.pkl`, `model_decision_tree.pkl`, `model_random_forest.pkl`, `model_xgboost.pkl`, `model_bagging.pkl`, `test_data.pkl`

*Note*: Replace `EXAMPLE_FOLDER_ID` with the actual Google Drive folder ID after uploading the files.

## Usage
1. **Training**:
   ```bash
   python train.py
   ```
   - Downloads the dataset.
   - Trains models and saves weights (`model_*.pkl`) and test data (`test_data.pkl`).
   - Outputs validation accuracy for each model.

2. **Evaluation**:
   ```bash
   python eval.py
   ```
   - Loads test data and model weights.
   - Reports classification metrics and confusion matrices for each model.

3. **Inference**:
   ```bash
   python infer.py
   ```
   - Loads the Random Forest model.
   - Predicts injury status for a sample input row.
   - Outputs the prediction (e.g., "Injured" or "Not Injured").

## Notes
- The `merged_df_cleaned` DataFrame is assumed to be preprocessed. Update `load_and_prepare_data` in `train.py` with your preprocessing steps.
- The sample input in `infer.py` uses dummy values. Modify `create_sample_input` to reflect realistic feature values for your dataset.
- Ensure model weights and test data are in the same directory as the scripts or update file paths accordingly.

## Repository Structure
```
nba_injuries_prediction/
├── train.py
├── eval.py
├── infer.py
├── README.md
├── injuries.csv  (downloaded by train.py)
├── model_*.pkl   (generated by train.py)
├── test_data.pkl (generated by train.py)
```